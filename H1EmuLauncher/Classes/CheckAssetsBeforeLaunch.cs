using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Security.Cryptography;
using System.Text;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Markup;
using System.Windows.Shapes;
using System.Windows.Threading;

namespace H1EmuLauncher.Classes
{
    class CheckAssetsBeforeLaunch
    {
        // List of allowed SHA-256 hashes
        static List<string> allowedHashes = new List<string>
        {
            "B1F599E01CF3C181B1BB81564AACDEDDFC375D9B0E741847A121ED36346AB263",
            "DF3A74B26BD99A8768D657C41B1CEE9E3D0D2AA4392839B26A15784E89010EC6",
            "5B37DFB0CF3F99C62B9AEFA723A69870F1256E10A4648B4F7D960D0116554F6F",
            "A5CBEDDEB64528692DD3B53A26868CEDB705A0C0A19BB039331307C997882EAB",
            "DEC84396B827A455CBAECC043C8F8F5C737B7D747507285AC454E6BCFF390E08",
            "7FA9003B40171C1D4EA095486B06737BAE57FF7EFB05C8D77C5094030351898F",
            "5273219DE6E504630AB2F4A3FCA0A0BB1BBD64C05736BC126A94285FDDDF7CDE",
            "812C7C3025C79F87660415A1405F23DD7D0B3C24414E544A79D5319105AD39F3",
            "3D4403C9286A54BE908F679D4A45919F63A18CFA5019137164644DB4FFF7A80C",
            "94E8649D9E5600CF36D035CFBD3E97770DAA64B32F4009112123FD41C23DB7EB",
            "89784474435E65316B857AB4A238C4B0A7559019B91C22EC309CA8758443DF70",
            "B2BE5CA7511FFA413D696384CDCF0EA5925AE60B1DA674768F7BC194072A86D7",
            "9E1E6DC3F1871079A2087301C2CDBBFF54AA5B91F02FCA0BCE53DD580E031F17",
            "F5B8F139525E7A3FCEC20224249B7426D36F24F3913A69D4732DCEEEF9C75E9C",
            "5FD18DA9ABC97CA9B5F0C3316D5CE4CF16C27038AA5CD5BAB1897900583723F6",
            "36E72D6A8ECD89929E898B8448F13E9E833B644CE7206C877DAC64C057CDA05E",
            "932DCFBE38E42AC392C86E56BBB880FACF3DB20232CF984A98F388B193489F52",
            "CF307B310DBFCACF27A963511C359491F11468D700536A9A12781D3D13CB44B6",
            "51E73383D8DDB0BEFDA1C4A35BCDFB46955299F2906294E265F3975C3E9BC34F",
            "4CB3823708618467CE2D503A01E9F52CD3C22591F3BC6F12B858E3A3307C839A",
            "6F0FDB41B1948171DFF68A8B38DB55FD84161D3C5D877465B69508A77F73D616",
            "CB0A23E71E7C0A6B29C998711D9CCA7C862D716F88C1C97A441146934907B5B1",
            "695C0893402DE231051638A2D35D02CC84E79B7608B5FFC67A57DF373DEAE3D0",
            "9C1DEB5DB91E9669D31FF84C7A8CBBA9364665C0E24F9E11F65AA08B23C7536B",
            "690F08E4609769C4B582DE30221AB8851A4BEDE7EA3A97DBCF8D8AD2025ADBA4",
            "D3236D4B8C59A67825016CF1E897380D6BA777C1BDDBBE46F85D411717A694CA",
            "5069A785AC0965B3E2E5A812657F1951EB4D4249A85B86F165688289F804583E",
            "7B9124939140DB32F4699AB3A2199B701FF8CB443EEB109FCB33D8DCBEE035E0",
            "4075CF587C713696AFA27117117E03ABFF95B2082CED5A761DA4C48A7DF59EBB",
            "C34201B9229922708E462C2984806711B8CAB2C53B725ECFD4078922F0C55F5E",
            "1018B9090015C00554F84D7653C3EB5A477D194BBE5FBA1F2CF89CEDB7BDA316",
            "A15F4A0DDF4802DF71EEA19312007245490888375461DC68F35E160E4995CE66",
            "0EA014AEEAD2D32617B3032F44014628F597DBB8003031BCFCEC63BDAB8EA18B",
            "DE3BFE1394D7B0C425F141314E395197035280A774EEC18E538BEEACF885B71A",
            "BE4A4BB680E9F3F739BBA58446F7BEF99D140D9DE878F1B91F293CA7D0E161D9",
            "83D180BE0E2C7A447445936C00AC3B1AAD414BA8C74AB0CDA903293A318DC8F0",
            "782E7197795F3018AE8FD4D6F6011F7A4CFF1ED1322303F5207D05ABD46CD10B",
            "4BDC8B54EF7CB6DF5F91E3BF24256446029C690F266E202A371337F41A995007",
            "0F42EFC69DAB352396A864B6B2BCFFE5CF0D5A313BA389B7E0FE5E225938E942",
            "E22D2F65BE520A389702155CB2F1160A2A6218FBF4F2C3B1BC667C865ABFDA45",
            "CC7E660F4F1238F37CAA7B65D94B64EBF0E433D26A9D8FE02F8064A147F7B5CB",
            "C491C14F78AF94B50C62C31E3054BA25967FC466020B59B7C43FDE753ABC930B",
            "70BA538699E6442E3999AD652A3915350243E9D470CCFDF23BBD8516F04E3CD1",
            "87B972CE1D4D06960E934EB8C95157A7268731C79D93F3912A4D354C6E2E859A",
            "4D2BF333BEC8316E42F7B11A2337D117944EF8F72DCF1F7C7EA84B0F236BBE2F",
            "5A3D1B379A95825A0486B03EC69AF4FB8271D41C5FB300753BD1C9FD8D6D52CF",
            "9E9F313A5432D8C6CAE696796F99D4C3AB8ED5559A924E42F4526BD242D18662",
            "05A8F25F14F6D35162F104DC4B91C872624105C47B90987316B951E7BD052BA4",
            "750C8941C93ED99CAD297941B3D4BD8FF1D0DC31CD6DBBD3077B07455BD13D06",
            "602636EF0B5D9E2DD5E4A6FCD966C907F04C46D646BCEBD630DD0892ECF7C0E4",
            "A6CDA6953C3E435D334BE49E6814715F53FFD75837BEDF1E427FBDEA02A0619A",
            "BF951A95F3DB3A44822E678442145BF84756F968F68CCECE13241608E39B1574",
            "BDBEA39024CD91A5754F84238B46E9A66B2D139E393FB69C5C48309D1408F91D",
            "045593875B8753E82FFF8703A83F867B858B2E50F6CD58CA3326910BC0D3E4AD",
            "795A897266C5E5182AB512FEF967CF406255F541019DC9E4B1C90ED54E8752E9",
            "8780FB9D5E1084752DEB2190E1FC86961EC02CCADE73B1EDFB18238338302B17",
            "8DE36C4C57FC3E02E366383F2519D8B66C4E645C8E098712EDF71DA1357909D4",
            "605D3982F90BBE3AAA09A678E3CEE536720572DECF1EA223AD2784DC56E17034",
            "97AB84E17FDE0027621CEF63925BF0CC18BAD8CF9209DD64F81D7C974F8D6AAD",
            "1BE709B8BDDB7A4B5DFEAF7823D98F54EDE43E5D2A23F61729C487142F372C9B",
            "99F4CDA462F76FCA90D2D2625FA7FAFF64B8838AFE4463C5C292682129AE8E44",
            "ECBCF5102FFDB50CB33A0F8E9F5CA95D04F0A7C913A19A985A2D407EEDDDCC56",
            "40E801863F978B0AC3FB5D1DDABE9F19B825485E223DD3C9391446217566EF74",
            "60A158B2F49F1EF493C8C1F20D87E197AB022DE92ABF2FF50383D14CED009E91",
            "F973B70F275762C23D4ABA75A2A0A54AFA35D71B3810548A45BC2AA7DF4F5A3F",
            "78C5287B6F029D83DB82C1FA0A3B1D0BD6744C29F1A84679951A7C889AAD3A17",
            "96E65E0C50203CDE7BF82A89AB5D9A252945C26A315D97B7B4EABF6CEDA2AB53",
            "D7228027151A0A36D01896881DF790FA5FC4E22940CF6E6757CDC48D726749DD",
            "9CD97CE95131FAC5689F8D1A448F5A95425B9D29984EA282E84E05D2CBC56BA7",
            "2078049A91021317282FE33266E948F971E9E81D2BBAB2A1DC14DF728F1F6C35",
            "4B3C02A73D4EFA8C6E773872178C66DF5E6448272A16B0BE06DC6114DBD73045",
            "BC46DBD32B1DB1E307926BFEE4BA4C0482FEB53404D5936E8542C0FD9AAD7F4B",
            "3CECBA6F22AD422B447B84056E1553B525B99BE2D45E8C2EA02CF747306C8FAC",
            "79DAA0F91322E41114A8FAE9009BF8C937F63187C2A3CD6C970FC88451F20FB8",
            "6428AE0B1FC25D42A885069799583290A9C0A75BB290894FAC3150B961B7212C",
            "61E8F55455B52944481E909F763DF999D55C37A81F237F31E965C6100D071919",
            "CB7159E382B24EC91C991248204B2EB8667CF62BB000989F1EC158F114829078",
            "80664908CD606AE4890A274221C05A61676D15B477DEE5B07DFB106F9A857CDF",
            "52F84599EEAB611A778C6F22D58975F09DE47DF8E4343233D779F23730AAF8C1",
            "C06DDB8CD47247510BCC27F5220694947CADA8ADC59D4845D2BA861A5DC48B59",
            "519B29A5EF8FC8F7485BE2ED14A04BCCA1BBF7BF1824D9D8A47449D3191C33A3",
            "0F6C8239BC70068B0826BB461D49B8B631BB8FEC2A7547E08DE37AD50B7D9A67",
            "2F0B523840FF634AD87C7604772C988D3AD51BC5636122A68F13F2815FA8A619",
            "D83A3D995C8F72F08474F5AB4D4D5B049972A7D0A07469C5719CC122FDB1BABF",
            "2F3B73628D7450F4C32D5B0F9966CB7EB9C4618D6489C364323683E41DABC217",
            "90B684A1FF954F9915A6D5326E05190B3ECE5DC9A360114B5DB96ECAACEB7E6B",
            "CB5679D8EDD76A61A5DAF8A302610A5FE5433D5D71CD09678E900670B8091A04",
            "184A30DDC0A73483A1E6F21A580BFD96842279B1512512E77DD1FAC5FD3F59FD",
            "4C41CE5843005DB3BAAC5969B745C1D226CC3FCA7D8B0F4986518C19E9FE783F",
            "1822AC148F438C82C204EC08046BAE6480B2942F535BC818F29CBC37F418A6C8",
            "92495B92DE6C45D9E0F62AE85C71CF819CA15C485CD040E48187B664F05D27CF",
            "C753EF21316EF46C32B31D062E8239A838B209BB2D21A92D2FF9995E6262E5FE",
            "56E614106B7C6B3F764CADE42651715D88B197C1B86FAF7107234191ED8B8E02",
            "35B13151EF6CB4B0C762827EBB5ED627EDC1BB346B00BB14CE7E708E9359D458",
            "73747A79CA18676ECC001BA2BBAE603B7D126588730C00AC3A29FCB0353AF01D",
            "21D106C6F509590412C7DBABF3287D6D9944EBF0D68F656914BE7F33C6B8D3CD",
            "8D9892CA999917D9842F5FDB713B0B13812773590FE31C51989CE7D301787F50",
            "F2D770725793337B64E97789160CE9D01E86209965B878D804286FEB6C55E1FA",
            "E05F89CC8DF04CDF86E82FC7DAA7C8A0A943D2CF0949BE521249D9F2213DC161",
            "7DA6A2B3EB5825417D8138227CFF7AAAD55EDD9F3188AA046490D0A620A8F1AC",
            "60EAE45DF520E056EF3D8DF9E810D7755D8541840EB54732185A57D0E24C5B28",
            "E158F6844F4EE8DA2E264AB2F208E38924F9B52BE01C36DB160291494E050A33",
            "4EB52AE30B11DCABBD327EF0AEC43F285324BC7985AAA6ED67779D03C74B6455",
            "B1C8A2ADDA739709147EA220C541A12084415C87DEC54B172DD3D496EB6E1BD5",
            "DF107E036A8AFF5134E6EE3C59C11C2AB9907A9C0ADDB1BC64EA20F4BF7EA85E",
            "9BB4D1E0F5222BCA0C1EAD0948D752C02268EAABD5212823F5162295ED0AA979",
            "1B8F345338A906E5CEF23950891D42EDD3A48A371F7C194D8157B14FCCBD4565",
            "D36B47ECA539832BC98A2D1F7596ECC11C17CF4872802E0CC26F2C508F67EFEA",
            "8588A085690C3FDB43B4E69A987CF266B157BB79E23A2CDF78AD6E25089699A1",
            "313D639DB047B7F75535A6DD56730E32D750C2C93D6703E7A355BCD1E39A707A",
            "1B021CF9448BF8E57D823B0A2E851F8DED102DB7A1842D165D2815A5EBA000AC",
            "9477205D3997A049432D665EACA0632A211F83F16CD8CD8017F1D15474D556BE",
            "EDE07F1B918575C56F6A599E683C396A4A1542224E90737D1C387AF0D1AD07F2",
            "02834D04BE1AECE06BCF8AEB2D11C3F510F9B05627D23C4259293CBD3A35C6C1",
            "A9236F3C028B5F85CC44CA4451AA33EE8E1D3140A56D233D4741997E1955875E",
            "CDACFB87DFBF00D3C157083E0BDA9808EDA25BDE01375C7355BD64CB6EE14938",
            "839876A52199615829C5133CFA6E5F5301DC7DDEA9AB3F5BD3CE37A7EAB845CD",
            "1416782E48519177124CA6D70FA1AB4F5196FB54740C27810AF927D5E4EE4AD7",
            "6D26EEE6BE9BF180DDF50B166C6B1DE6447116B5C920FECEE4C29D2FA4E8DE83",
            "46ACF17C85DD6746F4F21530B294D6D3648C679DE21C82A88AA7248FD1DECDE3",
            "71A4AAB091F62080F490DB63380AEC15DEE2BF5C15440A7F1F303B980986AA2F",
            "8906E9A8C5E58E3A301B88859B758587F1614EEE1D9717CF926EBA2AA765281D",
            "1253BE3FC08D3D8EDF26B460811429E8A31C1AFAFEC5A41BB985BF131B0148AD",
            "98E5DE2893A3A706CE6DCC9A5706153D515B7CF2358F36789789D3A65F7B84D9",
            "4E13417DFE7181E2032F6EE2D773F3A6D237D222EC96694D9B3FAA5F4AB49541",
            "1FE830C0547F794B759CA61E83706100C530627D981D5C139C354F5DE8F73BAF",
            "7BE72FD161754539E37D51F33A5B9D109F056DDB1E1360116AE8F5689AF3CD01",
            "59822403A30760C80AAB4F7CA649890BECD87B9223A6E5FF13AF1D641092FDCA",
            "84006FAFC07738D62905600A11418FDEDCA0DAAE9CAB9CABE916C46D8A284B4C",
            "6D2A39AB038780567265742EAFAA6F0469A7BD0051A64187FCDA13D2193ABD0E",
            "649F810DE536364EA83036E83AEA18A6844B4401C8F0B3A4073D933A61FD7D13",
            "DA064AFD56EDFB33DE658DCC3F8A6468B250C9FB07726A1AC4F0838BBFDBA6DA",
            "50C867F28B3676161F8D9360B46E744C5A74DFCB18CC8540D7EF13AB801F50B3",
            "C8704E0867186BAF65900A3381FB0AE856A0FE7029E3D21375DAEFD53D13D5D5",
            "35B5489CECDC37B2848BE13A6532205358554B342505D5F16C188005DB0CC439",
            "0C74BE3972CC196E4F539B533C49CB88B13D2CFD54C79DB7EE7D00ABB3FD7B19",
            "CF2DAB4423D6C5B7129566BCA9780A32EC48BE9EAC8589969F93384D1269DA1A",
            "549110936387ED8D59DDCDE24F5E41B4B4817225CFEE98DCF9ABDA3735CFF8FD",
            "F109145F21ECE4F6A9945142F41AF0B43C93FC1C71F9D246E1368B725BBBD8E0",
            "FAC762A3FCA51C24A4A5F6288CAEAA2295FA965E0B0EAF5250468872D3963037",
            "ABDA29348A5607B2EBB5B1F322540E47DE673490B6F9C8B490B49923DEFE895E",
            "AF891A39B7C5F82CB19AB9BB1A90F2E6B1FA2126E4DB1A0E3387AB5F255F2631",
            "9880F86FED789488D0624DE9723371CFFBBDF459229701DC9FE0E08755F75CDE",
            "358B034A6D3FCB1E4E0AE7E7C2CF212CB3BAECA02BE97809E51F60AB9887EBAA",
            "CDD9913A44128F49CD3284E557C7884F971CB489D6C3111120B5D89BEB02EBBB",
            "5AA7ACAC15C20EC4F37A496A88963D84EC685779208C296326963CAD0EB35A17",
            "D776CA8A7ECFC619465245DC046534FDBD6F6D9E4FB0E693131D9D0280E81F73",
            "C98C488553BE22787E064406EC5FF6F9DC74E2836962034001188C3BF848E84E",
            "061A802FC47B52F16598DFB0F8A19AEFF8053B315F327C8E23C7D9C92CA7FF50",
            "84203FB83D8DECDEB03166736D303B0D291EA6BF1A018971903F13BC1AD9E6F1",
            "A93ABFCC66DA9F165977957446B601F1B5879329D2831FE972CAC053A4EA039A",
            "B21C578C91698513F96BB2DE7B112C298C66D0520F618DCD9C7CA6FFBD490AB4",
            "B5FB546F7BFB39983E70C76529636AA31E75072255D10C78A96EC202637C74FB",
            "9FACFF41107C63416DE2D92833B44B57C14BC8FE1B6A14E7B8E8C1A38FDC9A85",
            "88469514EA5F3338B1FDE2615100A4C7E514B893DBB7409C84AD1D6FBC5BC95F",
            "ED5C9EB7052FAE1C6C0212B7E9AB7D0B7F91BF28684FD818E149081D788DAEF9",
            "0795254D623D6B29539282EFD19B2DA6AFD566FD49737C22C0D1D5320D7FFEDC",
            "D817011F7E8D6DC534EF17AF5F66A379004148270E54418F331899D8FDBA536C",
            "5446F47115BA1F708CD961003F2E1E8CA931F6ACFDAF8A19CF0D8A2AC87848B7",
            "2D1E8E85F667AEB1296001B9423AAC35645B82CFA7FD6B56E17935275681B0A1",
            "FFEA5D4C2478E8AACACFAC88BCB566CB404657CB502331641E58EE8AD86CD0E7",
            "95D9722623494B0DC2BD9B858AF4ABE3AF751AC7499CA63ECBF0ECA63E498BB5",
            "6E2540B5125886CC88D93AFFE98CB763CCCD08379F6F0477931C4B6BB2BAE823",
            "34936EF6B75E24DD32DA99314AE69037E05D0A94D7EE6C9A2DE67627F1A52DFB",
            "A965374D8DC1387C7B023F1010AA954B515EF41498E76023F9341F350CA38FB4",
            "9A599AF1B44ED442B935A305EF51F6ABA6A17551F2A90A717B8AE50AF1185339",
            "29CFAB4923F292A3BF3898BFA9FA507A4BFBD327328B86A4F602DBFDCFDA6950",
            "9A16C418B170A8D2EADF381353A630DCAFA17DD955DA6FC16FD4139244E76C08",
            "DE0D64A1A5A5309E471BEEB63637676795AA3442495365A296A0478DAFF14F11",
            "82A16625480FDFCB6339CB872432431B3682BCE268F1D6876E24F2D987CF8BE7",
            "D8E7689284B1E334CEB93C6E605FF61C2CA051D2375BFDDAED3A119C8BF5C425",
            "3004CBF9652B5834CE5698A8693FC9BF0BE4D63050FA0B2E77BEE3023122FB75",
            "1291864851C8A74AFB87C5751B0A08E3D63E1D2DF4EF786A347EB1198A901D20",
            "FE89A8F00B08FBB1878F3C9BC6DE5E9964CED4CC9AB64323D0A550EDA5A27092",
            "CBE7228A223EC20EE7A79AD0ED6D029BC06F16DE947551AB1D653EB0A829CAE9",
            "259B66958D37641D68CB1F4E4E31DD1B91375D43E143EE9B16E2A1F26F932F49",
            "09D80DB5146577A3BFD9D3E7AC9A22A1F5889B52576A60C5E614BCF37137F0BD",
            "BEB0481C24947258D421F91B3D2F034428A6B6AA7157CE4E7B6CEAD5D2F5290B",
            "41DD5BA493174FE0475BBA847D4B6DEDD67C408EFE8B0ECAEC0CDD4E5E058D03",
            "EF90BCA7093C24040E921975C23E0972C4E108B0AFA5737C8FD24BF5808A28F2",
            "84653774AA79C411FE7B48D21964D8A8289569C9A90668BAD43D634F6FA95DCF",
            "D29239E00AD3F2D3C073CA02BD52E0BBFA4DF3D3E2D1257EFA5B9975D27A26AA",
            "810BC1760A57F673A2B9FB3044A1D79E43E67D13CA207CD178504F9B469D9585",
            "5330F2B99452D1400EE07EC00833F2FC4C7D7985D3EABF2D0A9C1F9AC752B1E7",
            "33734B28338502EBE45C532E40C7969E4711FA0926BE06D5AA79B6EEE0F9F1DA",
            "1D2E729CE170E75A2BBB369F1F54AC04ED899E526CFBFA9174C44456580800C9",
            "AC3577FE7E981EE39706F7218F5C6143000E230CEC882FA37FE2F016DB9C9F87",
            "8C9D880ED8C5A8568B380D65F0CACE947E160FBD71D7996D49A7DAEEB0CBC0CA",
            "EAEAE19961DECA83521FECD4B3B2B56657FF518D27220F3650634076B0673FDE",
            "043A19534B79DE914FA06A2A98923CD21C6D1258E873991D47BD6E968E6FE61F",
            "4513E1F7F8652DF2FF2166E70948429E5E6011D45A7F03E8141D7150771155C8",
            "E4599AD96E8BEF988750A6AF31A2374138E767B98E7B5B8958D4708DE2C9F468",
            "31D9AC820A58188167A2ED05EDC5A1A29F84021E4468CAE8D4FE84C4B88C1D17",
            "50B74C0E364140617D01BE5EEFD964BDDD38EFEC6F3DE1F16B4FFC9CC61C19C7",
            "2E54EDA893B20F3414AB790F18FDCD9CE672772CA41AAFB6E5E24EE056F76FB5",
            "FCDF6C20E0A52036B816B21B979098875765C0EEA52644454BB1128E81265D10",
            "170243ADA4FD423FE9533EE325AF110D3AF439D8587B7A1A913646E9702FF6DA",
            "EF234A51487631B56F2DD05F8FD9C26FED88B2552EA7243F8A45049834E87A9F",
            "E045E3C92BF3713467509D53806DBEB8E2647098151E74F1157E2F2AD34FDCC0",
            "DE99A655D350915839C21B7843FA7F475D704A76DE241F0054E0C02EA476BBA9",
            "CD0145C41A8BC201E32416FD33449CD7F98E119ACC4DDC69A4F5E24C06A09E0D",
            "533BFC6D7A54E827E015F09B49D9CE5E043DD80C340A72E4B11C84F855DAB130",
            "B88E3F6EB8694561D396B50BB807435BC4AC962384F5505C581175C7514BBA67",
            "89B3E28021B3EB4B6DC347057054A2E310B91403E5FA164B66E8FE96AFE3B6D3",
            "384C6343B4E9073723A145C9B4AC1B2E5ACB2A4B0512709162380ED2767A1B1C",
            "FC5535B8E1817C95498A67E0C4F38C7401C37856079FC52EE43223B25C2D0D2F",
            "30DF91C4EEFB0DF3A0BB05937B7609EB577F800420BD1F1F593C30F1B09C841C",
            "CB1CA19D154866900C16E731BDF98AF5A7EC5FC6E14ED1EF6BE4C7376025C426",
            "23DA4D2DE847BED5DF9FCD87EEF555449E929C0A667BA09BBF1EA25194550858",
            "18BD0BFCF8F50802CEA8A4630DE183359773EEBA6135A506DA7A4ADCBD46A999",
            "5E88158EBB41928AAF93DEAFC1F01CDCB87B45D5C61E2C908A201C341DC3F55D",
            "ED199140CBCF1952FA8903EAB37CE994E7997FA3EEAAF5EF74A14D20783C0467",
            "DD931F95175298D3DB6B7B8134967EDB0AEA21296BD2EEE3E7FCF3CC04B998E6",
            "B8F9E567BE3CB74A63EA687B209F03B90FB98819419AB76435CA6DCF4FE9EFB5",
            "36BB7A82AE1C47227CFEB9BB1FEAA5C06B615473F8CD52B5BE8F5A4E9494E269",
            "4FF3BF3C7B2C0E0CFE53390B0B8042288779370E78626C5B4B6D504A82F995FE",
            "BF6322A8F1E4D0569AFD35D2E75D9729675048D4B0DC5F8094B45D007E4F2ABB",
            "78FC2F24B381D234ECF2BBF0949CD73B99A34105C1832DCC15791541BF073F5C",
            "370D34715B6DEFBDF61C9BE9DDAD02EFAE135EDDBB13EB9A226E9D49E4BB46F1",
            "C2E52C9E78506088437F9EA647805399EB83AD6DFAD570FA0A62791B8D75EDDD",
            "69E030258652BAF97671C59578FBAAA2802E34ED6B43FC7A6C56E5003E5FAE1F",
            "39F94D593EA10ABD8F09921754F4386518253C7FBC3EED9050034C157D9585D4",
            "F09B6112F8FEE18BEFD63818402AECABB62A57C6FC9BBA75ABB795DC9E39FDB9",
            "685C1818A9C8A44C3EA2623F34A6947BB15A92FA06F67AAC33AFBE5EDDD2C895",
            "A765C53E7F7AA6721387E8940AF25356D60A587FFDBA6E994FF550C39ED99D81",
            "851F75786A5984841EF00D7A7DE6AF560B44A8B4A805B78A81BDBDE565CACEF0",
            "B06C2F2433E9D27D602845A45F288883A35A9E70B7BEC1803F4C8DFEF535895F",
            "F2B1E0FAFCD9890F79CE10E3251BBE16A4972D35885EC972FBF25E872D83A013",
            "93612DC912A2776BC38DAC19123B130415B1AD09BEA4AF7226E089F78F133D55",
            "889AE2E63F008FF2B5BE5414664D665B21E618FAF766371D6DC691493C7C4AF9",
            "7D75554F80E234D1F278D10547447477FA9FAAD7F1B9E93054207D5DBE8659F5",
            "1876FFA7C07D8072B6406A73B497C4107244E934E7069D2F3CBAC16179CB7FA3",
            "59112368CDFA09E2EA5D5A2EC1A5E38DC4857010BCD1443AB96AF6F1F239EA5A",
            "6A270CB1AF7DED414D3A39E37B2008105795ED2F39854D8BCB3AD51E4430F1B2",
            "43CB9E749E72E6877FBBC1A6AD7D1FE5B663A7F2D9A568C9A546A1EE59A4ABA3",
            "DEC1377765ABEB1BD72BF52F74CA9852E0FA2F897084432945B101A72F674DAB",
            "108BF5EAA9B937D74BCE6F03A37EE4BEB0BF3A32F718E7C2B79917247587D21D",
            "79F326EAC5E8501BA88E278000FFF0CBD3F894FBF213E32F4DC0CFFC522D45B4",
            "221C97BE9421A72F140440F11442BA658D6215DF2D23B94D3A055746DC724BA2",
            "316BCD41F893396D05DEC8C3B9C95999BD785FD50F6B7166F1E9FD4A380B713F",
            "AB83E361A617EB1704ACC0E625EA47EF8117D5AC5B12C34C84EE2A89B9242A0A",
            "52D79AC0504EAE8F87D0CBF9EEC7DF9FD03912235680278FB42F9F91CD4B6B21",
            "AF853798DD5A883E60CF4AA1D548721D8EA71FA2317FA794C286280EE7B48A26",
            "CAEBEFE1F1FD873C3850C8408A4C58445A351F97E375BF1F2EAE287E47DC2DAC",
            "2068BB569DF0475525F06057AD858BED57BDAAFA8865293125BC5495FB49D7E0",
            "7F5D6B175B54E6F585381BAACA77FE4B332221B6FF2E94D77BB4356D886C03C0",
            "0BCD06D430CA8B2E5CC73BC2072EA53609BF9E80BB3AC0840E4B57767DDD7311",
            "97D8B0D05C16B6F883E1C3515FD9F146498ACD6D9BEECC135893400F4B45F45A",
            "A7F1C2621CC6F26AC0FD0A782885D34BD0CF94A4317ACA417ED30E9D218074E3",
            "A57822C483B8A13E2299CCA42F5D560C4262230A94E0EDF645B6FC1E7FE1FF83",
            "51579D3CDCB063220930866A2FB5BD9873145CF6844EB72629EAF1E41D52841E",
            "3CC82F20B2FFFD88756EF9946F629BA46A259E4E05D2FB9E7319C6C35498C871",
            "CA472E92282268EBC9BB4ABFAFB683ACB227F121FDC82723B52EFEE7DBA769C0",
            "D0449E0C2D9D0F044014F928AE2764DC4BAF25EBEB23DCEC75F3378E72A42821",
            "89474D8B763D7CDCD7F1C79DEAB311BF1F868A21809AF53A0FCD07B738B339EC",
            "C6937E425E419E97B95687B3F484BB9D813E91A0E0DFECC5A26316D4EB23A335",
            "F31F4451D3D3826B36D7A00C62D08966BCB11FFAE15DD968BB714EDFC080C67B",
            "D7D3576296109B38719B199B37C9650742498E8AB933FBEE27EB2033381B0D01",
            "B5AF8BFF664BEF0946558575C9667A4161FF1178C73DF06DD406AF40366047FD"
        };

        static string ComputeSHA256(string filePath)
        {
            try
            {
                using (FileStream stream = File.OpenRead(filePath))
                {
                    using (SHA256 sha256 = SHA256.Create())
                    {
                        byte[] hashBytes = sha256.ComputeHash(stream);
                        StringBuilder sb = new StringBuilder();
                        foreach (byte b in hashBytes)
                            sb.Append(b.ToString("x2"));

                        return sb.ToString();
                    }
                }
            }
            catch (Exception e)
            {
                Application.Current.Dispatcher.Invoke(new Action(delegate
                {
                    CustomMessageBox.Show($"{LauncherWindow.launcherInstance.FindResource("item215")} \"{e.Message}\".", LauncherWindow.launcherInstance, false, false, false, true);
                }));
                return null;
            }
        }

        public static void CheckAssets()
        {
            DirectoryInfo d = new DirectoryInfo($"{Properties.Settings.Default.activeDirectory}\\Resources\\Assets");
            if (d.GetFiles().Length < 1)
                return;

            Application.Current.Dispatcher.Invoke(new Action(delegate
            {
                LauncherWindow.launcherInstance.playButton.SetResourceReference(Button.ContentProperty, "item214");
            }));

            foreach (var file in d.GetFiles("*.pack"))
            {
                // Get the SHA-256 hash of the file
                string fileHash = ComputeSHA256(file.FullName).ToUpper();

                // Check hashes are in the list of allowed file(s)
                if (!allowedHashes.Contains(fileHash))
                {
                    Application.Current.Dispatcher.Invoke(new Action(delegate
                    {
                        CustomMessageBox.Show(LauncherWindow.launcherInstance.FindResource("item216").ToString(), LauncherWindow.launcherInstance, false, false, false, true);
                    }));
                    break;
                }
            }

            Application.Current.Dispatcher.Invoke(new Action(delegate
            {
                LauncherWindow.launcherInstance.playButton.SetResourceReference(Button.ContentProperty, "item8");
            }));
        }
    }
}
